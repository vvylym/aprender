<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080">
  
  <!-- LAYER 1: Background -->
  <rect width="1920" height="1080" fill="#ffffff"/>
  
  <!-- LAYER 2: Main panels -->
  <!-- Left: The Problem + Solution -->
  <rect x="40" y="140" width="580" height="800" fill="#1a202c" stroke="#2d3748" stroke-width="2" rx="8"/>
  <!-- Center: Catching the Bug -->
  <rect x="640" y="140" width="620" height="800" fill="#fff5f5" stroke="#fc8181" stroke-width="2" rx="8"/>
  <!-- Right: Healthy vs Broken -->
  <rect x="1280" y="140" width="600" height="800" fill="#f7fafc" stroke="#e2e8f0" stroke-width="2" rx="8"/>
  
  <!-- LAYER 3: The Problem (left top) -->
  
  <!-- Black box visualization -->
  <rect x="80" y="200" width="500" height="120" fill="#2d3748" stroke="#e53e3e" stroke-width="3" rx="8"/>
  
  <!-- Input arrow -->
  <rect x="100" y="240" width="120" height="40" fill="#38a169" stroke="#276749" stroke-width="2" rx="4"/>
  
  <!-- Question marks -->
  <rect x="240" y="240" width="50" height="40" fill="#4a5568" rx="4"/>
  <rect x="300" y="240" width="50" height="40" fill="#4a5568" rx="4"/>
  <rect x="360" y="240" width="50" height="40" fill="#4a5568" rx="4"/>
  
  <!-- Output (garbage) -->
  <rect x="430" y="240" width="130" height="40" fill="#e53e3e" stroke="#c53030" stroke-width="2" rx="4"/>
  
  <!-- Arrows inside -->
  <line x1="220" y1="260" x2="235" y2="260" stroke="#718096" stroke-width="2"/>
  <polygon points="235,254 250,260 235,266" fill="#718096"/>
  <line x1="290" y1="260" x2="295" y2="260" stroke="#718096" stroke-width="2"/>
  <polygon points="295,254 310,260 295,266" fill="#718096"/>
  <line x1="350" y1="260" x2="355" y2="260" stroke="#718096" stroke-width="2"/>
  <polygon points="355,254 370,260 355,266" fill="#718096"/>
  <line x1="410" y1="260" x2="425" y2="260" stroke="#718096" stroke-width="2"/>
  <polygon points="425,254 440,260 425,266" fill="#718096"/>
  
  <!-- LAYER 3: The Solution - Pipeline with traces (left bottom) -->
  
  <!-- Step 1: Tokenize -->
  <rect x="80" y="400" width="200" height="45" fill="#4a5568" stroke="#718096" stroke-width="2" rx="4"/>
  <rect x="290" y="400" width="250" height="45" fill="#276749" stroke="#38a169" stroke-width="2" rx="4"/>
  
  <!-- Arrow -->
  <line x1="180" y1="445" x2="180" y2="465" stroke="#718096" stroke-width="2"/>
  <polygon points="173,465 180,480 187,465" fill="#718096"/>
  
  <!-- Step 2: Embed -->
  <rect x="80" y="485" width="200" height="45" fill="#38a169" stroke="#276749" stroke-width="2" rx="4"/>
  <rect x="290" y="485" width="250" height="45" fill="#276749" stroke="#38a169" stroke-width="2" rx="4"/>
  
  <!-- Arrow -->
  <line x1="180" y1="530" x2="180" y2="550" stroke="#718096" stroke-width="2"/>
  <polygon points="173,550 180,565 187,550" fill="#718096"/>
  
  <!-- Step 3: Layers -->
  <rect x="80" y="570" width="200" height="60" fill="#3182ce" stroke="#2c5282" stroke-width="2" rx="4"/>
  <rect x="290" y="570" width="250" height="60" fill="#276749" stroke="#38a169" stroke-width="2" rx="4"/>
  
  <!-- Arrow -->
  <line x1="180" y1="630" x2="180" y2="650" stroke="#718096" stroke-width="2"/>
  <polygon points="173,650 180,665 187,650" fill="#718096"/>
  
  <!-- Step 4: LM Head -->
  <rect x="80" y="670" width="200" height="45" fill="#6b46c1" stroke="#553c9a" stroke-width="2" rx="4"/>
  <rect x="290" y="670" width="250" height="45" fill="#276749" stroke="#38a169" stroke-width="2" rx="4"/>
  
  <!-- Arrow -->
  <line x1="180" y1="715" x2="180" y2="735" stroke="#718096" stroke-width="2"/>
  <polygon points="173,735 180,750 187,735" fill="#718096"/>
  
  <!-- Step 5: Sample -->
  <rect x="80" y="755" width="200" height="45" fill="#ed8936" stroke="#c05621" stroke-width="2" rx="4"/>
  <rect x="290" y="755" width="250" height="45" fill="#276749" stroke="#38a169" stroke-width="2" rx="4"/>
  
  <!-- Arrow -->
  <line x1="180" y1="800" x2="180" y2="820" stroke="#718096" stroke-width="2"/>
  <polygon points="173,820 180,835 187,820" fill="#718096"/>
  
  <!-- Step 6: Decode -->
  <rect x="80" y="840" width="200" height="45" fill="#e53e3e" stroke="#c53030" stroke-width="2" rx="4"/>
  <rect x="290" y="840" width="250" height="45" fill="#e53e3e" stroke="#c53030" stroke-width="2" rx="4"/>
  
  <!-- LAYER 3: Catching the Bug (center) -->
  
  <!-- Without tracing -->
  <rect x="680" y="180" width="540" height="140" fill="#2d3748" stroke="#4a5568" stroke-width="2" rx="6"/>
  
  <!-- With tracing -->
  <rect x="680" y="340" width="540" height="300" fill="#f0fff4" stroke="#48bb78" stroke-width="2" rx="6"/>
  
  <!-- Check marks for steps 1-5 -->
  <rect x="700" y="390" width="140" height="30" fill="#38a169" rx="4"/>
  <rect x="700" y="430" width="140" height="30" fill="#38a169" rx="4"/>
  <rect x="700" y="470" width="140" height="30" fill="#38a169" rx="4"/>
  <rect x="700" y="510" width="140" height="30" fill="#38a169" rx="4"/>
  <rect x="700" y="550" width="140" height="30" fill="#38a169" rx="4"/>
  <rect x="700" y="590" width="140" height="30" fill="#e53e3e" rx="4"/>
  
  <!-- Error detail box -->
  <rect x="680" y="660" width="540" height="240" fill="#742a2a" stroke="#9b2c2c" stroke-width="3" rx="6"/>
  
  <!-- Error content boxes -->
  <rect x="700" y="720" width="500" height="35" fill="#9b2c2c" rx="4"/>
  <rect x="700" y="770" width="500" height="35" fill="#9b2c2c" rx="4"/>
  <rect x="700" y="820" width="500" height="60" fill="#c53030" stroke="#fc8181" stroke-width="2" rx="4"/>
  
  <!-- LAYER 3: Healthy vs Broken table (right) -->
  
  <!-- Table header -->
  <rect x="1320" y="200" width="520" height="50" fill="#2d3748" rx="4"/>
  
  <!-- Table rows -->
  <rect x="1320" y="260" width="520" height="70" fill="#f0fff4" stroke="#c6f6d5" stroke-width="1" rx="0"/>
  <rect x="1320" y="330" width="520" height="70" fill="#ffffff" stroke="#e2e8f0" stroke-width="1" rx="0"/>
  <rect x="1320" y="400" width="520" height="70" fill="#f0fff4" stroke="#c6f6d5" stroke-width="1" rx="0"/>
  <rect x="1320" y="470" width="520" height="70" fill="#ffffff" stroke="#e2e8f0" stroke-width="1" rx="0"/>
  <rect x="1320" y="540" width="520" height="70" fill="#f0fff4" stroke="#c6f6d5" stroke-width="1" rx="0"/>
  <rect x="1320" y="610" width="520" height="70" fill="#fff5f5" stroke="#fed7d7" stroke-width="2" rx="0"/>
  
  <!-- Column dividers -->
  <line x1="1420" y1="200" x2="1420" y2="680" stroke="#a0aec0" stroke-width="1"/>
  <line x1="1570" y1="200" x2="1570" y2="680" stroke="#a0aec0" stroke-width="1"/>
  <line x1="1720" y1="200" x2="1720" y2="680" stroke="#a0aec0" stroke-width="1"/>
  
  <!-- TL;DR box -->
  <rect x="1320" y="720" width="520" height="180" fill="#ebf8ff" stroke="#4299e1" stroke-width="2" rx="6"/>
  
  <!-- Bullet points visual -->
  <circle cx="1345" cy="780" r="6" fill="#3182ce"/>
  <circle cx="1345" cy="820" r="6" fill="#3182ce"/>
  <circle cx="1345" cy="860" r="6" fill="#3182ce"/>
  
  <!-- LAYER 5: TEXT (always last) -->
  
  <!-- Title -->
  <text x="960" y="60" font-family="Georgia, Times, serif" font-size="44" fill="#1a202c" text-anchor="middle" font-weight="600">Inference Tracing: Debugging the Black Box</text>
  <text x="960" y="100" font-family="Georgia, Times, serif" font-size="20" fill="#718096" text-anchor="middle">printf debugging for neural networks — find exactly where inference breaks</text>
  
  <!-- Left panel header -->
  <text x="330" y="175" font-family="Georgia, Times, serif" font-size="20" fill="#ffffff" text-anchor="middle" font-weight="600">THE PROBLEM</text>
  
  <!-- Black box labels -->
  <text x="160" y="267" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">"2+2?"</text>
  <text x="265" y="267" font-family="Georgia, Times, serif" font-size="16" fill="#a0aec0" text-anchor="middle">?</text>
  <text x="325" y="267" font-family="Georgia, Times, serif" font-size="16" fill="#a0aec0" text-anchor="middle">?</text>
  <text x="385" y="267" font-family="Georgia, Times, serif" font-size="16" fill="#a0aec0" text-anchor="middle">?</text>
  <text x="495" y="267" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">garbage</text>
  
  <text x="330" y="340" font-family="Georgia, Times, serif" font-size="16" fill="#fc8181" text-anchor="middle">WHERE DID IT BREAK?</text>
  
  <!-- Solution header -->
  <text x="330" y="380" font-family="Georgia, Times, serif" font-size="18" fill="#48bb78" text-anchor="middle" font-weight="600">THE SOLUTION: TRACE POINTS</text>
  
  <!-- Step labels -->
  <text x="180" y="430" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">1. TOKENIZE</text>
  <text x="415" y="422" font-family="Georgia, Times, serif" font-size="14" fill="#c6f6d5" text-anchor="middle">"def add" → [3, 1025, 8234]</text>
  <text x="415" y="438" font-family="Georgia, Times, serif" font-size="14" fill="#9ae6b4" text-anchor="middle">IDs in vocab range? ✓</text>
  
  <text x="180" y="515" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">2. EMBED</text>
  <text x="415" y="507" font-family="Georgia, Times, serif" font-size="14" fill="#c6f6d5" text-anchor="middle">[7] → [7, 1536] floats</text>
  <text x="415" y="523" font-family="Georgia, Times, serif" font-size="14" fill="#9ae6b4" text-anchor="middle">No NaN/Inf? ✓</text>
  
  <text x="180" y="600" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">3. LAYERS ×28</text>
  <text x="415" y="592" font-family="Georgia, Times, serif" font-size="14" fill="#c6f6d5" text-anchor="middle">Layer N: attn → ffn</text>
  <text x="415" y="608" font-family="Georgia, Times, serif" font-size="14" fill="#9ae6b4" text-anchor="middle">Range stable? ✓</text>
  
  <text x="180" y="700" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">4. LM_HEAD</text>
  <text x="415" y="692" font-family="Georgia, Times, serif" font-size="14" fill="#c6f6d5" text-anchor="middle">[1536] → [151936] logits</text>
  <text x="415" y="708" font-family="Georgia, Times, serif" font-size="14" fill="#9ae6b4" text-anchor="middle">Top-5 sensible? ✓</text>
  
  <text x="180" y="785" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">5. SAMPLE</text>
  <text x="415" y="777" font-family="Georgia, Times, serif" font-size="14" fill="#c6f6d5" text-anchor="middle">temp=0.7 → id=471</text>
  <text x="415" y="793" font-family="Georgia, Times, serif" font-size="14" fill="#9ae6b4" text-anchor="middle">ID in bounds? ✓</text>
  
  <text x="180" y="870" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">6. DECODE</text>
  <text x="415" y="862" font-family="Georgia, Times, serif" font-size="14" fill="#fed7d7" text-anchor="middle">vocab[8765] = ???</text>
  <text x="415" y="878" font-family="Georgia, Times, serif" font-size="14" fill="#fc8181" text-anchor="middle">OUT OF BOUNDS ✗</text>
  
  <!-- Center panel header -->
  <text x="950" y="168" font-family="Georgia, Times, serif" font-size="18" fill="#c53030" text-anchor="middle" font-weight="600">CATCHING APR-TOK-001</text>
  
  <!-- Without tracing -->
  <text x="950" y="210" font-family="Georgia, Times, serif" font-size="16" fill="#a0aec0" text-anchor="middle">WITHOUT TRACING:</text>
  <text x="950" y="245" font-family="Georgia, Times, serif" font-size="14" fill="#e2e8f0" text-anchor="middle">Input: "What is 2+2?"</text>
  <text x="950" y="275" font-family="Georgia, Times, serif" font-size="14" fill="#fc8181" text-anchor="middle">Output: "𥅿𥅿𥅿𥅿𥅿..."</text>
  <text x="950" y="305" font-family="Georgia, Times, serif" font-size="16" fill="#a0aec0" text-anchor="middle">Debug: ¯\_(ツ)_/¯</text>
  
  <!-- With tracing header -->
  <text x="950" y="370" font-family="Georgia, Times, serif" font-size="16" fill="#276749" text-anchor="middle" font-weight="500">WITH TRACING:</text>
  
  <!-- Check marks -->
  <text x="770" y="412" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">TOKENIZE ✓</text>
  <text x="770" y="452" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">EMBED ✓</text>
  <text x="770" y="492" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">LAYERS ✓</text>
  <text x="770" y="532" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">LM_HEAD ✓</text>
  <text x="770" y="572" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">SAMPLE ✓</text>
  <text x="770" y="612" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle">DECODE ✗</text>
  
  <!-- Status indicators -->
  <text x="900" y="412" font-family="Georgia, Times, serif" font-size="14" fill="#276749">[1/6]</text>
  <text x="900" y="452" font-family="Georgia, Times, serif" font-size="14" fill="#276749">[2/6]</text>
  <text x="900" y="492" font-family="Georgia, Times, serif" font-size="14" fill="#276749">[3/6]</text>
  <text x="900" y="532" font-family="Georgia, Times, serif" font-size="14" fill="#276749">[4/6]</text>
  <text x="900" y="572" font-family="Georgia, Times, serif" font-size="14" fill="#276749">[5/6] id=8765</text>
  <text x="900" y="612" font-family="Georgia, Times, serif" font-size="14" fill="#c53030">[6/6] ERROR!</text>
  
  <!-- Error box header -->
  <text x="950" y="695" font-family="Georgia, Times, serif" font-size="18" fill="#fc8181" text-anchor="middle" font-weight="600">ROOT CAUSE IDENTIFIED</text>
  
  <!-- Error details -->
  <text x="950" y="745" font-family="Georgia, Times, serif" font-size="14" fill="#fed7d7" text-anchor="middle">Token ID: 8765    Vocab[8765]: OUT OF BOUNDS</text>
  <text x="950" y="795" font-family="Georgia, Times, serif" font-size="14" fill="#fed7d7" text-anchor="middle">GGUF header says vocab_size = 151936</text>
  <text x="950" y="845" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle" font-weight="500">Actually loaded tokens: 8000</text>
  <text x="950" y="870" font-family="Georgia, Times, serif" font-size="14" fill="#fc8181" text-anchor="middle">→ ggml.tokens metadata not parsed!</text>
  
  <!-- Right panel header -->
  <text x="1580" y="175" font-family="Georgia, Times, serif" font-size="18" fill="#2d3748" text-anchor="middle" font-weight="600">HEALTHY vs BROKEN</text>
  
  <!-- Table headers -->
  <text x="1370" y="232" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle" font-weight="500">Step</text>
  <text x="1495" y="232" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle" font-weight="500">Healthy</text>
  <text x="1645" y="232" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle" font-weight="500">Broken</text>
  <text x="1780" y="232" font-family="Georgia, Times, serif" font-size="14" fill="#ffffff" text-anchor="middle" font-weight="500">Symptom</text>
  
  <!-- Row 1: Tokenize -->
  <text x="1370" y="295" font-family="Georgia, Times, serif" font-size="14" fill="#2d3748" text-anchor="middle" font-weight="500">TOKENIZE</text>
  <text x="1495" y="290" font-family="Georgia, Times, serif" font-size="14" fill="#276749" text-anchor="middle">[3, 1025,</text>
  <text x="1495" y="308" font-family="Georgia, Times, serif" font-size="14" fill="#276749" text-anchor="middle">8234]</text>
  <text x="1645" y="295" font-family="Georgia, Times, serif" font-size="14" fill="#c53030" text-anchor="middle">[3, 0, 0, 0]</text>
  <text x="1780" y="290" font-family="Georgia, Times, serif" font-size="14" fill="#718096" text-anchor="middle">Unknown →</text>
  <text x="1780" y="308" font-family="Georgia, Times, serif" font-size="14" fill="#718096" text-anchor="middle">UNK</text>
  
  <!-- Row 2: Embed -->
  <text x="1370" y="365" font-family="Georgia, Times, serif" font-size="14" fill="#2d3748" text-anchor="middle" font-weight="500">EMBED</text>
  <text x="1495" y="360" font-family="Georgia, Times, serif" font-size="14" fill="#276749" text-anchor="middle">[-0.5, 0.5]</text>
  <text x="1495" y="378" font-family="Georgia, Times, serif" font-size="14" fill="#276749" text-anchor="middle">range</text>
  <text x="1645" y="365" font-family="Georgia, Times, serif" font-size="14" fill="#c53030" text-anchor="middle">[NaN, NaN]</text>
  <text x="1780" y="365" font-family="Georgia, Times, serif" font-size="14" fill="#718096" text-anchor="middle">OOV token</text>
  
  <!-- Row 3: Layers -->
  <text x="1370" y="435" font-family="Georgia, Times, serif" font-size="14" fill="#2d3748" text-anchor="middle" font-weight="500">LAYERS</text>
  <text x="1495" y="430" font-family="Georgia, Times, serif" font-size="14" fill="#276749" text-anchor="middle">[-3, 3]</text>
  <text x="1495" y="448" font-family="Georgia, Times, serif" font-size="14" fill="#276749" text-anchor="middle">range</text>
  <text x="1645" y="435" font-family="Georgia, Times, serif" font-size="14" fill="#c53030" text-anchor="middle">[-inf, inf]</text>
  <text x="1780" y="430" font-family="Georgia, Times, serif" font-size="14" fill="#718096" text-anchor="middle">Numerical</text>
  <text x="1780" y="448" font-family="Georgia, Times, serif" font-size="14" fill="#718096" text-anchor="middle">instability</text>
  
  <!-- Row 4: LM_HEAD -->
  <text x="1370" y="505" font-family="Georgia, Times, serif" font-size="14" fill="#2d3748" text-anchor="middle" font-weight="500">LM_HEAD</text>
  <text x="1495" y="500" font-family="Georgia, Times, serif" font-size="14" fill="#276749" text-anchor="middle">return=4.2</text>
  <text x="1495" y="518" font-family="Georgia, Times, serif" font-size="14" fill="#276749" text-anchor="middle">top token</text>
  <text x="1645" y="500" font-family="Georgia, Times, serif" font-size="14" fill="#c53030" text-anchor="middle">&lt;unk&gt;=99</text>
  <text x="1645" y="518" font-family="Georgia, Times, serif" font-size="14" fill="#c53030" text-anchor="middle">dominates</text>
  <text x="1780" y="505" font-family="Georgia, Times, serif" font-size="14" fill="#718096" text-anchor="middle">Broken wts</text>
  
  <!-- Row 5: Sample -->
  <text x="1370" y="575" font-family="Georgia, Times, serif" font-size="14" fill="#2d3748" text-anchor="middle" font-weight="500">SAMPLE</text>
  <text x="1495" y="575" font-family="Georgia, Times, serif" font-size="14" fill="#276749" text-anchor="middle">id=471</text>
  <text x="1645" y="575" font-family="Georgia, Times, serif" font-size="14" fill="#c53030" text-anchor="middle">id=999999</text>
  <text x="1780" y="575" font-family="Georgia, Times, serif" font-size="14" fill="#718096" text-anchor="middle">Bad logits</text>
  
  <!-- Row 6: Decode (highlighted) -->
  <text x="1370" y="645" font-family="Georgia, Times, serif" font-size="14" fill="#c53030" text-anchor="middle" font-weight="600">DECODE</text>
  <text x="1495" y="645" font-family="Georgia, Times, serif" font-size="14" fill="#276749" text-anchor="middle">"return"</text>
  <text x="1645" y="645" font-family="Georgia, Times, serif" font-size="14" fill="#c53030" text-anchor="middle">"𥅿𥅿𥅿"</text>
  <text x="1780" y="640" font-family="Georgia, Times, serif" font-size="14" fill="#c53030" text-anchor="middle">ID &gt; vocab</text>
  <text x="1780" y="658" font-family="Georgia, Times, serif" font-size="14" fill="#c53030" text-anchor="middle" font-weight="500">APR-TOK-001</text>
  
  <!-- TL;DR header -->
  <text x="1580" y="755" font-family="Georgia, Times, serif" font-size="16" fill="#2c5282" text-anchor="middle" font-weight="600">TL;DR: TRACING = PRINTF FOR NNs</text>
  
  <!-- Bullet points -->
  <text x="1365" y="785" font-family="Georgia, Times, serif" font-size="14" fill="#2d3748">Input/output shapes at each step</text>
  <text x="1365" y="825" font-family="Georgia, Times, serif" font-size="14" fill="#2d3748">Sanity checks (NaN, range, bounds)</text>
  <text x="1365" y="865" font-family="Georgia, Times, serif" font-size="14" fill="#2d3748">Bug at step N → problem is in step N</text>
  
  <!-- Bottom tagline -->
  <text x="960" y="1000" font-family="Georgia, Times, serif" font-size="24" fill="#2d3748" text-anchor="middle" font-weight="500">Each step logs: shape, values, sanity checks, timing.</text>
  <text x="960" y="1040" font-family="Georgia, Times, serif" font-size="18" fill="#718096" text-anchor="middle">Bug at step N? Check the transform between step N-1 and N.</text>

</svg>