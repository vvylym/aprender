# PMAT Quality Gate Configuration
# Aprender - Next-generation ML library in pure Rust
# Toyota Way standards from aprender-spec-v1.md
# pmat version: 2.200.0

[gates]
# Clippy linter (strict mode)
run_clippy = true
clippy_strict = true  # -D warnings (zero tolerance)

# Test suite (current: 742 tests)
run_tests = true
test_timeout = 300  # 5 minutes

# Code coverage (current: 91.2%, target: ≥85%)
check_coverage = true
min_coverage = 85.0

# Cyclomatic complexity (Toyota Way: ≤10)
check_complexity = true
max_complexity = 10
max_cognitive_complexity = 15

# SATD (Self-Admitted Technical Debt) - Zero Tolerance
check_satd = true
max_satd_comments = 0  # No TODO/FIXME/HACK allowed
satd_severity = "critical"  # Fail on any SATD

# Mutation testing (current: 85.3%, target: ≥85%)
run_mutation = false  # Expensive, run in CI only
min_mutation_score = 85.0

# Technical Debt Grading (current: 95.2/100)
check_tdg = true
min_tdg_score = 95.0  # A+ grade required
tdg_grade = "A+"

# Code formatting
check_format = true
format_command = "cargo fmt --check"

# Documentation coverage
check_docs = true
min_doc_coverage = 90.0

# Security audit
check_security = true
allow_security_warnings = false

[hooks]
# Pre-commit enforcement
enabled = true
fail_on_complexity = true
fail_on_satd = true
fail_on_fmt = true
fail_on_clippy = true
fail_on_tests = true

[ci]
# CI/CD requirements (Tier 4 gates)
require_tests = true
require_coverage = true
require_clippy = true
require_fmt = true
require_mutation = true
require_security_audit = true
require_tdg_check = true
require_benchmarks = false  # Optional for now

[rust]
# Rust-specific settings
check_unwraps = true  # CRITICAL: 326 unwrap() calls to fix
max_unwraps = 0  # Target: zero unwrap() in production code
rust_project_score_min = 120  # Current: 124/134

[thresholds]
# Performance regression thresholds
max_benchmark_regression_percent = 5.0  # ±5% tolerance

[reporting]
# Report generation
generate_markdown = true
report_path = "docs/quality-reports"
track_trends = true

[results]
# Last achieved metrics (auto-updated by pmat)
test_coverage = 91.2
mutation_score = 85.3
tdg_score = 95.2
cyclomatic_complexity_max = 9
cognitive_complexity_max = 8
satd_comments = 0  # Production code only
rust_project_score = 124.0
unwrap_count = 326  # TODO: Reduce to 0
last_updated = "2025-11-21"

[targets]
# Quality improvement targets
target_test_coverage = 95.0
target_mutation_score = 90.0
target_tdg_score = 98.0
target_unwrap_count = 0
target_rust_project_score = 130.0
